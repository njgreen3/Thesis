\chapter{Energy Conversion}
\label{ch:conv}

Energy and power take many different forms, from the initial sources to the end uses. Necessarily, methods have been developed to convert energy or power from one form to another. The first method addressed in this chapter is the conversion process of thermal to mechanical to electrical energy found in heat engines and generators. This thesis is focused on geothermal heat, however, heat engines can be used with a number of different sources including the burning of a fuel such as biomass or coal, or even as waste heat from an independent process. The conversion between different forms of thermal energy and electrical power will also be discussed including electrical generators and power electronic converters that are used to form a grid in ORC prime power systems.

\input{NG_geotherm} %used to contain geothermal chapter, now contains thermal section


\section{Electrical Generators}
%This section should focus the difference between the two with respect to geothermal sources. I can have a fundemental description of the generators either in this chapter or the intro chapter.
Electrical generators are spinning machines which convert the mechanical power rotating a shaft to electrical power. Fundamentally, they operate on the principles of Maxwell's and Faraday's laws which broadly state that a moving magnetic field produces an electric field and vice versa. The primary difference among generator types is how that magnetic field is produced. 
%As previously described, asynchronous generators, also called induction generators, are incapable maintaining a grid. Synchronous generators supply or absorb reactive power depending on the needs of the grid.

\subsection{Synchronous Generators}
The magnetic field in synchronous generators is formed by external sources. The name derives from the fact that electric frequency directly synchronizes with the physical rotation of the machine.\footnote{Certain wiring configurations add additional electromagnetic poles to machine which causes the mechanical speed to be slower than the electrical speed by a factor of the integer number of poles.} They are also capable of supplying reactive power because the internal magnetic field is not self induced. 

In traditional synchronous machines an electro-magnet is used to generate the field by running a DC current through the rotational, or rotor, windings. The spinning DC electric field produces a magnetic field, which in turn makes an electric field in the stationary, or stator, windings. By varying the DC current applied to the rotor, the user can control the voltage generated by the machine. The current sets the magnetic flux which in turn controls the voltage \cite{Chapman2005}. As discussed in \autoref{sec:droop}, droop control takes advantage of the relationship between voltage and reactive power to ensure they are appropriately balanced.

In permanent magnet synchronous generators (PMSG) bar magnets are used to form the magnetic field of the rotor. A benefit of using permanent magnets over electro-magnets is the lack of slip rings or brushes used to apply the DC current to the rotor winding. These components can introduce a source of friction and wear down over time. However, since permanent magnetic fields are fixed at the time of construction, the user cannot control the voltage of the machine without full power electronic conversion between the generator and the grid.
\nomenclature[B]{PMSG}{Permanent magnet synchronous generator}

\subsection{Asynchronous Generators}
Asynchronous (induction) machines generate their internal magnetic fields by self-induction rather than from an external source. Since induction machines do not rely on an additional source to operate, induction machines generally have simpler designs and are less costly than synchronous machines. However, that also means they need to consume reactive power from the grid in order to maintain their magnetic field. This field relies on the relative difference in frequency between the stator, $f_{s}$, and rotor, $f_{r}$, fields. This relative difference in frequency is represented by the machine's slip, %$s = \frac{f_{s} - f_{r}}{f_{s}}$ 
\cite{Chapman2005}
\begin{equation}
	s = \frac{f_{s} - f_{r}}{f_{s}}.
\end{equation}
\nomenclature[V]{$s$}{Slip of induction machine}

The stator frequency is equal to the grid frequency at the output terminal, while the rotor frequency is determined by the rotor's speed, $n_r$, and number of poles, where 
\begin{equation}
	f_r = \frac{n_r \times poles}{120}.
\end{equation}
The number of poles is based off the number of coil windings per phase and established at construction. When the machine's slip is positive, the field frequency in the stator is greater than in the rotor, and the machine operates as a motor. A negative slip means the rotor is spinning faster than the frequency of the stator and the machine is acting as a generator. 

Some work has been done on self-excited induction generators (SEIG) \cite{Ouazenne1983, Ammasaigounden1986}. Instead of solely consuming reactive power from the grid, induction generators use a bank of capacitors connected at their terminals to supply the necessary reactive power in order to maintain the magnetic field in the rotor. However, a significant drawback to these devices is the lack of control over frequency and voltage \cite{Bansal2005}. SEIGs require some form of power electronic conversion at the output terminals to regulate the grid side frequency and voltage. This can be achieved with full power electronic conversion, similar to PMSGs, where the generator output is entirely rectified and inverted to synchronize with the grid. Alternatively, two sets of windings can be be used around the rotor instead of one, in what is called a doubly fed induction generator (DFIG). The primary set form the stator, which connects directly with the grid\footnote{Via a transformer.} and is used to deliver power. The auxiliary set of windings are connected to the grid through a power electronic converter. This converter can be used to control the rotor current to ensure consistent frequency and voltage despite variable rotational speeds \cite{Muller2002, Bogalecka2002}.
\nomenclature[B]{SEIG}{Self excited induction generator}
\nomenclature[B]{DFIG}{Doubly fed induction generator}

\section{Power Electronic Conversion}
As described previously, electronic conversion takes electric power from either an AC or DC form and converts it to a different form or level. This is generally done by switching the path of the input current to form the desired output. Control over the switching is critical for these conversion devices. Pulse Width Modulation (PWM) and Pulse Frequency Modulation (PFM) are two alternate methods of controlling switching states of the semiconductor devices. Both methods vary the duty cycle, $D$, of the control signal of the device in order to change the on/off state. The duty cycle is the fractional time a switch is on, $t_{on}$, relative to one period of the control signal, $T$, or 
\begin{equation}
D = \frac{t_{on}}{T}. 
\end{equation}
For PWM the switching frequency is held constant while the duration of the pulse is varied to control the output. In PFM, the duration of each pulse is fixed while time between pulses, and therefore, the frequency varies.
\nomenclature[B]{PWM}{Pulse width modulation}
\nomenclature[B]{PFM}{Pulse frequency modulation}
\nomenclature[V]{$D$}{Duty cycle}
\nomenclature[V]{$t_{on}$}{Time a switch is in the on state\nomunit{\si{\second}}}
\nomenclature[V]{$T$}{Time of one period in a cycle\nomunit{\si{\second}}}
%\subsection{Linear Power Supplies}
%Linear

%\subsection{Switched Mode Power Supplies}

\subsection{DC-DC}
%description, diagram, and waveform of simple buck and boost converters
DC-DC power conversion devices can generally be divided up into three simple designs: buck to step voltage down, boost to step voltage up, and buck-boost to step voltage down or up depending on the source voltage. 
%These two designs can be combined into a single buck-boost converter capable of increasing or decreasing the voltage. 
There are additional DC-DC converter topologies which use the same concepts in these designs, but are modified to create different characteristics \cite{Mohan2003}.
%These include but are not limited to C\'uk, SEPIC, Flyback, Forward, Half-bridge, and Full-bridge converters \cite{Mohan2003}.

In a simple buck converter, seen in \autoref{fig:simple_buck}, timed switching sets the average output voltage to a value smaller than the input, or 
\begin{equation}
V_{out} = D V_{in}. 
\end{equation}
The inductor ensures a continuous current at the output and the capacitor provides an output voltage with only modest ripple. 
%Example waveforms of input and output current and voltage can be seen for a simple buck converter in fig X.

\input{figures/simple_buck}

In a simple boost converter, seen in \autoref{fig:simple_boost}, timed switching also sets the average output voltage to the desired level, but with the relationship 
\begin{equation}
V_{out} =\frac{V_{in}}{1-D}. 
\end{equation}
However, the placement of the components leads to an increasing current through the inductor while the switch is closed. When the switch is open, the relatively high current flow through the diode results in a larger average output voltage than seen at the input. As in the buck converter, the capacitor provides an output voltage with modest ripple. 
%Example waveforms of input and output current and voltage can be seen for a simple buck converter in fig X.

\input{figures/simple_boost}

These two topologies can be combined to form a buck-boost converter, seen in \autoref{fig:simple_buck_boost} which has an input/output voltage relationship of 
\begin{equation}
V_{out} = V_{in}\frac{D}{1-D}. 
\end{equation}
This configuration allows the output voltage to be either greater than the input voltage for $D > 0.5$ or less than the input voltage for $D < 0.5$. It must be noted that while this orientation gives a greater voltage range at the output, the output voltage has a negative polarity. With appropriate electrical isolation, the polarity should not impact the operation of the buck-boost converter, but using a common ground between the input and output will cause the circuit to fail.

\input{figures/simple_buck_boost}

\subsection{Rectifier and Inverter}
%description, diagram, and waveform of simple rectifier
Simple rectifiers use a combination of diodes to convert an AC voltage to DC. \autoref{fig:3ph_rectifier} shows a simple example of a three phase rectifier. The diodes allow a path such that the DC current always flows in the same direction regardless of AC polarity. More advanced designs will use active switching devices and a control scheme to provide the same function. Though more complicated to implement, the user has more direct control over the output as well as how the load appears to the input. 
%Example waveforms of input and output current and voltage can be seen for a simple buck converter in fig X.
\input{figures/3ph_rectifier}


%\subsection{Inverter}
%description, diagram, and waveform of simple inverter
Inverters function as rectifiers in reverse. A DC source is switched on and off such that it alternates periodically. The three phase inverter diagram, seen in \autoref{fig:3ph_inverter}, is similar to the rectifier diagram, except the inverter must use active switching. In fact many inverters are designed to be reversible. The device can control the flow of active and reactive power in inverter mode or rectifier mode.
\input{figures/3ph_inverter}

Depending on how the inverter is expected to interact with other components on the grid, different control schemes may be needed to shape the output signal appropriately. When operating in a grid-forming mode, the inverter must be capable of regulating the frequency and voltage and is called a voltage source inverter (VSI) \cite{Engler}. When an inverter is operating in grid-following mode, it uses the grid to set its output frequency and voltage and supplies power based on active and reactive power setpoints. Grid-following inverters are also called current source inverters (CSI). Grid-supporting units usually assist the grid-forming source or inverter with frequency and voltage regulation often using droop or similar methods of control as discussed in \autoref{sec:droop}. Lastly, grid-parallel inverters supply power based off of references at the input instead of the grid, and are often used with wind turbines and solar PV arrays to provide the maximum power possible \cite{Mohd2009}.
\nomenclature[B]{VSI}{Voltage source inverter}
\nomenclature[B]{CSI}{Current source inverter}

\subsection{AC-DC-AC}
In certain situations, full power electronic conversion is necessary, where an AC source is rectified to DC, then inverted back to AC at the output. This is done when the power source is generating unregulated AC, such as with SEIGs and PMSGs, but the grid or load requires regulated AC \cite{ALOLAH1994111, Seung-HoSong2003}. In other instances, either end of the converter is regulated independently, so a DC link is required to exchange power, such as with DC interties \cite{Okada}.

\section{ORC Manufacturers and Developers}
A partial list of ORC system developers can be seen in \autoref{tab:orc_manufacturers_dev} with fewer than ten documented installed systems. A list of commercial systems with more than ten documented systems installed can be seen in \autoref{tab:orc_manufacturers_com}. Both tables also include, if available, the working fluid used, the mechanical drive, the approximate maximum rotational speed, the generator type, and the rated output. These tables show R245-fa\footnote{\ch{CF3CH2CHF2} (1,1,1,3,3- pentafluoropropane)} is commonly used as a working fluid among these manufacturers. Furthermore, these devices mostly use induction machines or PMSGs, although there is a documented instance using a DC generator. For the machines using PMSGs, a grid-following electronic conversion device is used to convert the generator output to match that of the grid, while the induction generators connect directly to the grid for a source of reactive power and to regulate their frequency and voltage.
\input{tables/orc_manufacturers_table} 
\nomenclature[B]{R245-fa}{Working fluid \ch{CF3CH2CHF2} (1,1,1,3,3- pentafluoropropane)}

\cleardoublepage